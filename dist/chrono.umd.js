(function(i,s){typeof exports=="object"&&typeof module<"u"?s(exports):typeof define=="function"&&define.amd?define(["exports"],s):(i=typeof globalThis<"u"?globalThis:i||self,s(i.Chrono={}))})(this,function(i){"use strict";class s{constructor(t={}){this.callbacks=[],this.now=0,this.rafId=null,this.isRunning=!1,this.maxFPS=0,this.lastFrameTime=0,this.frameInterval=0,this.isFirstFrame=!0,this.now=performance.now(),this.maxFPS=t.maxFPS||0,this.frameInterval=this.maxFPS?1e3/this.maxFPS:0,this.raf=this.raf.bind(this),t.autoStart!==!1&&this.start()}start(){this.isRunning||(this.isRunning=!0,this.lastFrameTime=performance.now(),this.isFirstFrame=!0,this.rafId=requestAnimationFrame(this.raf))}stop(){this.isRunning&&this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.isRunning=!1,this.rafId=null)}add(t,e=0){return this.callbacks.push({callback:t,priority:e}),this.callbacks.sort((r,a)=>r.priority-a.priority),()=>this.remove(t)}remove(t){this.callbacks=this.callbacks.filter(({callback:e})=>t!==e)}clear(){this.callbacks=[]}getCallbacks(){return[...this.callbacks]}raf(t){if(!this.isRunning)return;const e=t-this.now;if(this.now=t,this.maxFPS&&!this.isFirstFrame){if(t-this.lastFrameTime<this.frameInterval){this.rafId=requestAnimationFrame(this.raf);return}this.lastFrameTime=t}for(const{callback:r}of this.callbacks)try{r(t,e)}catch(a){console.error("Error in animation callback:",a)}this.rafId=requestAnimationFrame(this.raf),this.isFirstFrame&&(this.isFirstFrame=!1,this.lastFrameTime=t)}}function n(l){try{return typeof window>"u"?null:new s(l)}catch(t){return console.warn("Failed to create Chrono instance:",t),null}}const h=n();i.Chrono=s,i.chronoInstance=h,i.createChronoInstance=n,i.default=h,Object.defineProperties(i,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
//# sourceMappingURL=chrono.umd.js.map
